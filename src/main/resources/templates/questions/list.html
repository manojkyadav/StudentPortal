<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<div th:fragment="content">
  <div th:replace="~{fragments/header :: header}"></div>

  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>Questions</h2>
    <a class="btn btn-primary" th:href="@{/app/questions/new}">+ New Question</a>
  </div>

    <table class="table table-striped table-hover align-middle">
      <thead class="table-light text-center">
      <tr>
        <th>ID</th>
        <th>Class</th>
        <th>Subject</th>
        <th>Topic</th>
        <th>Question</th>
        <th>Type</th>
        <th>Difficulty</th>
        <th>Correct Option</th>
        <th>Status</th>
        <th>Created At</th>
        <th>Actions</th>
      </tr>
    </thead>

    <tbody>
      <tr th:each="q : ${questions}">
        <td th:text="${q.id}">1</td>
        <td th:text="${q.classRoom != null ? q.classRoom.className : '-'}">Class Name</td>
        <td th:text="${q.subject != null ? q.subject.subjectName : '-'}">Subject</td>
        <td th:text="${q.topics != null ? q.topics.topicName : '-'}">Topic</td>
        <td th:text="${#strings.abbreviate(q.questionTxt, 60)}">Question text...</td>
        <td th:text="${q.questionType}">MULTIPLE_CHOICE</td>
        <td th:text="${q.difficultyLevel}">MEDIUM</td>

        <!-- Display correct option(s) if available -->
        <td>
          <ul class="mb-0 ps-3" th:if="${q.options != null}">
            <li th:each="opt : ${q.options}" 
                th:if="${opt.isCorrect}" 
                th:text="${opt.optionText}">Correct option text</li>
          </ul>
        </td>

        <td th:text="${q.status}">ACTIVE</td>
        <td th:text="${#temporals.format(q.createdAt, 'yyyy-MM-dd HH:mm')}">2025-11-09</td>

        <td>
          <div class="btn-group" role="group">
            <a th:href="@{|/app/questions/edit/${q.id}?classId=${q.classRoom.id}&subjectId=${q.subject.id}&topicsId=${q.topics.id}|}" class="btn btn-sm btn-outline-primary">Edit</a>
            <a th:href="@{|/app/questions/delete/${q.id}|}" 
               class="btn btn-sm btn-outline-danger" 
               onclick="return confirm('Are you sure you want to delete this question?');">Delete</a>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<!-- Main Layout -->
<div th:replace="~{layout :: layout(~{::content})}"></div>
</html>
